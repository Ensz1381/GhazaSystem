@using GhazaSystem.UI.Services
@using Microsoft.AspNetCore.Components.Forms
@inject ISnackbar Snackbar
@inject FoodServices foodServices


<MudDialog>
    <DialogContent>
        <MudStack Spacing="3">
            <MudTextField @bind-Value="foodForm.Name"
                         Placeholder="انتخاب کنید"
                         Label="نام غذا" 
                         Variant="Variant.Outlined"
                         Required="true"
                         Adornment="Adornment.Start"
                         AdornmentIcon="@Icons.Material.Filled.Restaurant" />

            <MudTextField @bind-Value="foodForm.Description" 
                         Label="توضیحات" 
                         Variant="Variant.Outlined"
                         Lines="3" />

            <MudNumericField @bind-Value="foodForm.Amount" 
                            Label="قیمت (تومان)" 
                            Variant="Variant.Outlined"
                            Min="0"
                            Adornment="Adornment.End"
                            AdornmentText="تومان" />

            <MudSelect T="string" 
                      @bind-Value="category" 
                      Label="دسته‌بندی" 
                      Variant="Variant.Outlined">
                <MudSelectItem Value="@("ایرانی")">ایرانی</MudSelectItem>
                <MudSelectItem Value="@("فست فود")">فست فود</MudSelectItem>
            </MudSelect>

            <MudFileUpload T="IBrowserFile" 
                          @bind-Files="selectedFile" 
                          OnFilesChanged ="InputChange"
                          Accept="image/*"
                          MaximumFileCount="1">
                          <ActivatorContent>
                                <MudButton  
                                      HtmlTag="label"
                                      Variant="Variant.Outlined"
                                      Color="Color.Primary"
                                       StartIcon="@Icons.Material.Filled.CloudUpload" >

                                       انتخاب تصویر غذا
                                 </MudButton>
                           </ActivatorContent>
                <SelectedTemplate>
                     <MudProgressCircular Color="Color.Default" Value="@_value">
                         <ChildContent>
                             @_value %
                         </ChildContent>
                    </MudProgressCircular>
                </SelectedTemplate>

                <SelectedTemplate>
                    @if (context != null)
                    {
                        <MudChip T="string" Color="Color.Success" 
                                Icon="@Icons.Material.Filled.AttachFile">
                            @context.Name
                        </MudChip>
                    }
                </SelectedTemplate>
            </MudFileUpload>

           

            @if (imagePreview != null)
            {
                <MudImage Src="@imagePreview" 
                         Alt="پیش‌نمایش" 
                         Elevation="2" 
                         Class="rounded-lg" 
                         ObjectFit="ObjectFit.Cover"
                         Height="200" />
            }

            <MudProgressCircular Color="Color.Default" Value="@_value">
                         <ChildContent>
                    @_value %
                         </ChildContent>
                    </MudProgressCircular>
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" Color="Color.Default">انصراف</MudButton>
        <MudButton OnClick="Submit" Color="Color.Success" Variant="Variant.Filled">افزودن</MudButton>
    </DialogActions>
</MudDialog>

